import{c as b,r as c,E as N,B as d,j as e,W as S}from"./index-DwH2koU-.js";import{R as C}from"./refresh-cw-DSLgdYKS.js";import{S as X}from"./settings-CAVvSHhq.js";import{T as A}from"./truck-CFFM20aK.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=b("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j=b("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=b("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),O={general:{siteName:"",supportEmail:"",phoneNumber:"",address:""},delivery:{minOrderAmount:1e3,freeDeliveryAmount:5e3,deliveryPrice:300,maxDeliveryDistance:30},notifications:{emailNotifications:!0,smsNotifications:!0,orderStatusUpdates:!0,marketingEmails:!1},maintenance:{maintenanceMode:!1,maintenanceMessage:"Сайт находится на техническом обслуживании. Пожалуйста, попробуйте позже."}},P=[{id:"general",name:"Общие",icon:X},{id:"delivery",name:"Доставка",icon:A},{id:"notifications",name:"Уведомления",icon:M},{id:"maintenance",name:"Обслуживание",icon:S}];function T(){const[r,g]=c.useState(O),[o,u]=c.useState(!0),[t,h]=c.useState({}),[x,p]=c.useState(!1),[y,k]=c.useState("general");c.useEffect(()=>{f()},[]),c.useEffect(()=>{const a=s=>{x&&(s.preventDefault(),s.returnValue="")};return window.addEventListener("beforeunload",a),()=>window.removeEventListener("beforeunload",a)},[x]);const f=async()=>{u(!0);try{const a=await N.getSettings();a&&g(a)}catch(a){console.error("Ошибка при загрузке настроек:",a),d.error("Ошибка при загрузке настроек")}finally{u(!1)}},v=async a=>{a.preventDefault();const s=D(r);if(Object.keys(s).length>0){h(s),d.error("Пожалуйста, исправьте ошибки перед сохранением");return}if(window.confirm("Вы уверены, что хотите сохранить изменения?")){u(!0);try{await N.updateSettings(r),d.success("Настройки успешно сохранены"),p(!1)}catch(l){d.error((l==null?void 0:l.message)||"Ошибка при сохранении настроек"),console.error("Ошибка при сохранении настроек:",l)}finally{u(!1)}}},w=async()=>{x&&!window.confirm("Вы уверены? Все несохраненные изменения будут потеряны.")||(await f(),p(!1),h({}),d.info("Настройки сброшены к последней сохраненной версии"))},n=(a,s,l)=>{g(i=>({...i,[a]:{...i[a],[s]:l}})),p(!0),t[s]&&h(i=>{const m={...i};return delete m[s],m})},D=a=>{var l,i,m;const s={};return(l=a.general.siteName)!=null&&l.trim()||(s.siteName="Название сайта обязательно"),(i=a.general.supportEmail)!=null&&i.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.general.supportEmail)||(s.supportEmail="Некорректный формат email"):s.supportEmail="Email поддержки обязателен",(m=a.general.phoneNumber)!=null&&m.trim()?/^\+7\d{10}$/.test(a.general.phoneNumber)||(s.phoneNumber="Формат телефона: +7XXXXXXXXXX"):s.phoneNumber="Телефон обязателен",a.delivery.minOrderAmount<0&&(s.minOrderAmount="Сумма не может быть отрицательной"),a.delivery.freeDeliveryAmount<a.delivery.minOrderAmount&&(s.freeDeliveryAmount="Сумма бесплатной доставки должна быть больше минимальной суммы заказа"),a.delivery.deliveryPrice<0&&(s.deliveryPrice="Стоимость доставки не может быть отрицательной"),a.delivery.maxDeliveryDistance<1&&(s.maxDeliveryDistance="Минимальное расстояние доставки - 1 км"),s},E=()=>{switch(y){case"general":return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Название сайта"}),e.jsx("input",{type:"text",value:r.general.siteName,onChange:a=>n("general","siteName",a.target.value),className:`input w-full ${t.siteName?"border-red-500":""}`,placeholder:"Введите название сайта"}),t.siteName&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.siteName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email поддержки"}),e.jsx("input",{type:"email",value:r.general.supportEmail,onChange:a=>n("general","supportEmail",a.target.value),className:`input w-full ${t.supportEmail?"border-red-500":""}`,placeholder:"support@example.com"}),t.supportEmail&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.supportEmail})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Телефон"}),e.jsx("input",{type:"text",value:r.general.phoneNumber,onChange:a=>n("general","phoneNumber",a.target.value),className:`input w-full ${t.phoneNumber?"border-red-500":""}`,placeholder:"+7XXXXXXXXXX"}),t.phoneNumber&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.phoneNumber})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Адрес"}),e.jsx("input",{type:"text",value:r.general.address,onChange:a=>n("general","address",a.target.value),className:"input w-full",placeholder:"Введите адрес"})]})]});case"delivery":return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Минимальная сумма заказа (₽)"}),e.jsx("input",{type:"number",value:r.delivery.minOrderAmount,onChange:a=>n("delivery","minOrderAmount",parseInt(a.target.value)),className:`input w-full ${t.minOrderAmount?"border-red-500":""}`,min:"0"}),t.minOrderAmount&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.minOrderAmount})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Сумма для бесплатной доставки (₽)"}),e.jsx("input",{type:"number",value:r.delivery.freeDeliveryAmount,onChange:a=>n("delivery","freeDeliveryAmount",parseInt(a.target.value)),className:`input w-full ${t.freeDeliveryAmount?"border-red-500":""}`,min:"0"}),t.freeDeliveryAmount&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.freeDeliveryAmount})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Стоимость доставки (₽)"}),e.jsx("input",{type:"number",value:r.delivery.deliveryPrice,onChange:a=>n("delivery","deliveryPrice",parseInt(a.target.value)),className:`input w-full ${t.deliveryPrice?"border-red-500":""}`,min:"0"}),t.deliveryPrice&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.deliveryPrice})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Максимальное расстояние доставки (км)"}),e.jsx("input",{type:"number",value:r.delivery.maxDeliveryDistance,onChange:a=>n("delivery","maxDeliveryDistance",parseInt(a.target.value)),className:`input w-full ${t.maxDeliveryDistance?"border-red-500":""}`,min:"1"}),t.maxDeliveryDistance&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.maxDeliveryDistance})]})]});case"notifications":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Email уведомления"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Получать уведомления на email"})]}),e.jsxs("div",{className:"relative inline-block w-12 mr-2 align-middle select-none",children:[e.jsx("input",{type:"checkbox",id:"emailNotifications",checked:r.notifications.emailNotifications,onChange:a=>n("notifications","emailNotifications",a.target.checked),className:"toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer"}),e.jsx("label",{htmlFor:"emailNotifications",className:"toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"SMS уведомления"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Получать уведомления по SMS"})]}),e.jsxs("div",{className:"relative inline-block w-12 mr-2 align-middle select-none",children:[e.jsx("input",{type:"checkbox",id:"smsNotifications",checked:r.notifications.smsNotifications,onChange:a=>n("notifications","smsNotifications",a.target.checked),className:"toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer"}),e.jsx("label",{htmlFor:"smsNotifications",className:"toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Обновления статуса заказа"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Получать уведомления об изменении статуса заказа"})]}),e.jsxs("div",{className:"relative inline-block w-12 mr-2 align-middle select-none",children:[e.jsx("input",{type:"checkbox",id:"orderStatusUpdates",checked:r.notifications.orderStatusUpdates,onChange:a=>n("notifications","orderStatusUpdates",a.target.checked),className:"toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer"}),e.jsx("label",{htmlFor:"orderStatusUpdates",className:"toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Маркетинговые рассылки"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Получать новости и специальные предложения"})]}),e.jsxs("div",{className:"relative inline-block w-12 mr-2 align-middle select-none",children:[e.jsx("input",{type:"checkbox",id:"marketingEmails",checked:r.notifications.marketingEmails,onChange:a=>n("notifications","marketingEmails",a.target.checked),className:"toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer"}),e.jsx("label",{htmlFor:"marketingEmails",className:"toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"})]})]})]});case"maintenance":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Режим обслуживания"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Включить режим технического обслуживания сайта"})]}),e.jsxs("div",{className:"relative inline-block w-12 mr-2 align-middle select-none",children:[e.jsx("input",{type:"checkbox",id:"maintenanceMode",checked:r.maintenance.maintenanceMode,onChange:a=>n("maintenance","maintenanceMode",a.target.checked),className:"toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer"}),e.jsx("label",{htmlFor:"maintenanceMode",className:"toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Сообщение о техническом обслуживании"}),e.jsx("textarea",{value:r.maintenance.maintenanceMessage,onChange:a=>n("maintenance","maintenanceMessage",a.target.value),rows:"4",className:"input w-full",placeholder:"Введите сообщение, которое будет показано пользователям"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Это сообщение будет отображаться всем посетителям сайта при включенном режиме обслуживания"})]})]});default:return null}};return o?e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx(j,{className:"w-8 h-8 animate-spin"})}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Настройки системы"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{type:"button",onClick:w,className:"btn btn-secondary flex items-center",disabled:o,children:[e.jsx(C,{className:`h-5 w-5 mr-2 ${o?"animate-spin":""}`}),"Сбросить"]}),e.jsxs("button",{onClick:v,className:"btn btn-primary flex items-center",disabled:o||!x,children:[o?e.jsx(j,{className:"h-5 w-5 mr-2 animate-spin"}):e.jsx($,{className:"h-5 w-5 mr-2"}),"Сохранить изменения"]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex -mb-px",children:P.map(({id:a,name:s,icon:l})=>e.jsxs("button",{onClick:()=>k(a),className:`
                  flex-1 px-4 py-4 text-center border-b-2 font-medium text-sm
                  ${y===a?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}
                `,children:[e.jsx(l,{className:"w-5 h-5 mx-auto mb-1"}),s]},a))})}),e.jsx("div",{className:"p-6",children:e.jsx("form",{onSubmit:v,className:"space-y-6",children:E()})})]})]})}export{T as default};
