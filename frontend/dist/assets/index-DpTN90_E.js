const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/react-vendor-BE4BdE5o.css"])))=>i.map(i=>d[i]);
import{B as c,j as s,u as pe,i as ge,l as ae,m as te,r as p,L as f,O as he,n as me,N as xe,o as fe,h as ye,P as je,p as Le,Q as Ce}from"./react-vendor-BB4BkCfL.js";import{c as g,a as C,b as _e}from"./redux-vendor-56JQh752.js";import{aq as be}from"./vendor-Dh_iZ00o.js";import{S as we,u as Ie,a as Ae,P as W,O as K,D as Se,B as j,L as Ee,b as ke,c as ve,d as S,e as Pe,A as Re,C as ne,T as Oe,I as Y,M as ze,f as De,g as E,h as Te,i as Fe,j as Be,k as J,l as X,m as Ne,n as $e,H as Ge,o as Ue,p as Ve,q as Me,r as qe}from"./mui-vendor-QnVK6N-v.js";const He=function(){const e=typeof document<"u"&&document.createElement("link").relList;return e&&e.supports&&e.supports("modulepreload")?"modulepreload":"preload"}(),Qe=function(a){return"/"+a},Z={},h=function(e,r,n){let t=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),d=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));t=Promise.allSettled(r.map(y=>{if(y=Qe(y),y in Z)return;Z[y]=!0;const L=y.endsWith(".css"),_=L?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${_}`))return;const x=document.createElement("link");if(x.rel=L?"stylesheet":He,L||(x.as="script"),x.crossOrigin="",x.href=y,d&&x.setAttribute("nonce",d),document.head.appendChild(x),L)return new Promise((A,b)=>{x.addEventListener("load",A),x.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${y}`)))})}))}function i(o){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=o,window.dispatchEvent(d),!d.defaultPrevented)throw o}return t.then(o=>{for(const d of o||[])d.status==="rejected"&&i(d.reason);return e().catch(i)})},We=`${window.location.protocol}//${window.location.host}/api`,l=be.create({baseURL:We,headers:{"Content-Type":"application/json"},withCredentials:!0});l.interceptors.request.use(a=>a,a=>Promise.reject(a));l.interceptors.response.use(a=>a,a=>{var e;return((e=a.response)==null?void 0:e.status)===401&&(window.location.href="/login"),Promise.reject(a)});const Dr={getAll:()=>l.get("/products"),getById:a=>l.get(`/products/${a}`),create:a=>l.post("/products",a),update:(a,e)=>l.put(`/products/${a}`,e),delete:a=>l.delete(`/products/${a}`)},Tr={getAll:()=>l.get("/game-keys"),getById:a=>l.get(`/game-keys/${a}`),create:a=>l.post("/game-keys",a),update:(a,e)=>l.put(`/game-keys/${a}`,e),delete:a=>l.delete(`/game-keys/${a}`),toggleVisibility:a=>l.patch(`/game-keys/${a}/toggle-visibility`)},Ke={user:null,isAuthenticated:!1,isAdmin:!1,isLoading:!1,initialized:!1,error:null},k=g("auth/updateProfile",async(a,{rejectWithValue:e})=>{var r,n;try{return(await l.put("/users/profile",a)).data}catch(t){return e(((n=(r=t.response)==null?void 0:r.data)==null?void 0:n.message)||"Ошибка обновления профиля")}}),v=g("auth/register",async(a,{rejectWithValue:e})=>{var r,n;try{return(await l.post("/auth/register",a)).data}catch(t){return e(((n=(r=t.response)==null?void 0:r.data)==null?void 0:n.message)||"Ошибка регистрации")}}),P=g("auth/login",async(a,{rejectWithValue:e})=>{var r,n;try{return(await l.post("/auth/login",a)).data}catch(t){return e(((n=(r=t.response)==null?void 0:r.data)==null?void 0:n.message)||"Ошибка входа")}}),w=g("auth/logout",async(a,{rejectWithValue:e})=>{var r,n;try{return(await l.post("/auth/logout")).data}catch(t){return e(((n=(r=t.response)==null?void 0:r.data)==null?void 0:n.message)||"Ошибка выхода")}}),I=g("auth/checkStatus",async(a,{rejectWithValue:e})=>{var r,n;try{return(await l.get("/auth/me")).data}catch(t){return e(((n=(r=t.response)==null?void 0:r.data)==null?void 0:n.message)||"Ошибка проверки статуса")}}),oe=C({name:"auth",initialState:Ke,reducers:{setInitialized:(a,e)=>{a.initialized=e.payload},resetError:a=>{a.error=null}},extraReducers:a=>{a.addCase(v.pending,e=>{e.isLoading=!0,e.error=null}).addCase(v.fulfilled,(e,r)=>{r.payload.success?(e.isLoading=!1,e.error=null,c.success("Успешная регистрация")):(e.isLoading=!1,e.error=r.payload.message||"Неизвестная ошибка",c.error(e.error))}).addCase(v.rejected,(e,r)=>{e.isLoading=!1,e.error=r.payload,c.error(r.payload)}).addCase(P.pending,e=>{e.isLoading=!0,e.error=null}).addCase(P.fulfilled,(e,r)=>{var n;r.payload.success&&((n=r.payload.data)!=null&&n.user)?(e.isLoading=!1,e.isAuthenticated=!0,e.user=r.payload.data.user,e.isAdmin=r.payload.data.user.role==="admin",e.error=null,c.success("Успешный вход в систему")):(e.isLoading=!1,e.error=r.payload.message||"Неизвестная ошибка",c.error(e.error))}).addCase(P.rejected,(e,r)=>{e.isLoading=!1,e.error=r.payload,e.isAuthenticated=!1,e.user=null,e.isAdmin=!1,c.error(r.payload)}).addCase(w.pending,e=>{e.isLoading=!0}).addCase(w.fulfilled,e=>{e.isLoading=!1,e.isAuthenticated=!1,e.user=null,e.isAdmin=!1,e.error=null,c.success("Успешный выход из системы")}).addCase(w.rejected,(e,r)=>{e.isLoading=!1,e.error=r.payload,c.error(r.payload)}).addCase(I.pending,e=>{e.isLoading=!0}).addCase(I.fulfilled,(e,r)=>{var n;r.payload.success&&((n=r.payload.data)!=null&&n.user)?(e.isLoading=!1,e.isAuthenticated=!0,e.user=r.payload.data.user,e.isAdmin=r.payload.data.user.role==="admin",e.error=null):(e.isLoading=!1,e.error=r.payload.message||"Неизвестная ошибка")}).addCase(I.rejected,(e,r)=>{e.isLoading=!1,e.isAuthenticated=!1,e.user=null,e.isAdmin=!1,e.error=r.payload}).addCase(k.pending,e=>{e.isLoading=!0,e.error=null}).addCase(k.fulfilled,(e,r)=>{r.payload.success?(e.isLoading=!1,e.error=null,e.user=r.payload.data.user,c.success("Успешное обновление профиля")):(e.isLoading=!1,e.error=r.payload.message||"Неизвестная ошибка",c.error(e.error))}).addCase(k.rejected,(e,r)=>{e.isLoading=!1,e.error=r.payload,c.error(r.payload)})}}),{setInitialized:ee,resetError:Fr}=oe.actions,Ye=oe.reducer,Je=a=>s.jsx(we,{...a,children:s.jsx("path",{d:"M21.58,16.09l-1.09-7.66C20.21,6.46,18.52,5,16.53,5H7.47C5.48,5,3.79,6.46,3.51,8.43l-1.09,7.66 C2.2,17.63,3.39,19,4.94,19h0c0.68,0,1.32-0.27,1.8-0.75L9,16h6l2.25,2.25c0.48,0.48,1.13,0.75,1.8,0.75h0 C20.61,19,21.8,17.63,21.58,16.09z M11,11H9v2H8v-2H6v-1h2V8h1v2h2V11z M15,10c-0.55,0-1-0.45-1-1c0-0.55,0.45-1,1-1s1,0.45,1,1 C16,9.55,15.55,10,15,10z M17,13c-0.55,0-1-0.45-1-1c0-0.55,0.45-1,1-1s1,0.45,1,1C18,12.55,17.55,13,17,13z"})});function R(){return s.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[s.jsx(Je,{sx:{fontSize:"2rem",mr:1,color:"transparent",background:"linear-gradient(45deg, #FFD700, #FFA500)",backgroundClip:"text",WebkitBackgroundClip:"text",filter:"drop-shadow(0 0 2px rgba(255, 215, 0, 0.5))","& path":{fill:"url(#gold-gradient)"}}}),s.jsx("svg",{width:"0",height:"0",children:s.jsx("defs",{children:s.jsxs("linearGradient",{id:"gold-gradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[s.jsx("stop",{offset:"0%",style:{stopColor:"#FFD700"}}),s.jsx("stop",{offset:"100%",style:{stopColor:"#FFA500"}})]})})}),s.jsx("span",{style:{background:"linear-gradient(45deg, #FFD700, #FFA500)",WebkitBackgroundClip:"text",backgroundClip:"text",color:"transparent",fontSize:"1.5rem",fontWeight:"bold",textShadow:"0 0 2px rgba(255, 215, 0, 0.3)"},children:"GameGold"})]})}function Xe(){var Q;const a=Ie();Ae(a.breakpoints.down("md"));const e=pe(),r=ge(),n=ae(),{user:t}=te(u=>u.auth);p.useState(null);const[i,o]=p.useState(null),[d,y]=p.useState(!1),L=u=>{o(u.currentTarget)},_=()=>{o(null)},x=()=>{y(!d)},A=async()=>{try{await n(w()).unwrap(),e("/"),c.success("Вы успешно вышли из системы")}catch(u){c.error(u.message||"Ошибка при выходе из системы")}_()},b=[{label:"Главная",path:"/",icon:s.jsx(Ge,{})},{label:"Игры",path:"/games",icon:s.jsx(Ue,{})},{label:"Контакты",path:"/contact",icon:s.jsx(Ve,{})},...t?[{label:"Корзина",path:"/cart",icon:s.jsx(Me,{badgeContent:0,color:"error",children:s.jsx(K,{})})}]:[]],ce=[{label:"Профиль",path:"/profile",icon:s.jsx(W,{})},{label:"Мои заказы",path:"/orders",icon:s.jsx(K,{})},...((Q=t==null?void 0:t.role)==null?void 0:Q.toLowerCase())==="admin"?[{label:"Админ панель",path:"/admin/dashboard",icon:s.jsx(Se,{})}]:[]],ue=s.jsxs(j,{onClick:x,sx:{textAlign:"center"},children:[s.jsx(j,{sx:{my:2},children:s.jsx(f,{to:"/",style:{textDecoration:"none",color:"inherit"},children:s.jsx(R,{})})}),s.jsx(Ee,{children:b.map(u=>s.jsx(ke,{disablePadding:!0,children:s.jsxs(ve,{component:f,to:u.path,selected:r.pathname===u.path,sx:{textAlign:"left","&.Mui-selected":{backgroundColor:"primary.main",color:"white","&:hover":{backgroundColor:"primary.dark"}}},children:[s.jsx(S,{sx:{color:r.pathname===u.path?"white":"inherit"},children:u.icon}),s.jsx(Pe,{primary:u.label})]})},u.path))})]});return s.jsx(Re,{position:"sticky",elevation:1,sx:{bgcolor:"background.paper",color:"text.primary"},children:s.jsx(ne,{maxWidth:"xl",children:s.jsxs(Oe,{disableGutters:!0,children:[s.jsx(j,{sx:{display:{xs:"none",md:"flex"},mr:2},children:s.jsx(f,{to:"/",style:{textDecoration:"none",color:"inherit"},children:s.jsx(R,{})})}),s.jsxs(j,{sx:{flexGrow:1,display:{xs:"flex",md:"none"}},children:[s.jsx(Y,{size:"large","aria-label":"menu","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:x,color:"inherit",children:s.jsx(ze,{})}),s.jsx(De,{anchor:a.direction==="rtl"?"right":"left",open:d,onClose:x,ModalProps:{keepMounted:!0},sx:{display:{xs:"block",md:"none"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:240,bgcolor:"background.paper"}},children:ue})]}),s.jsx(j,{sx:{flexGrow:1,display:{xs:"flex",md:"none"},justifyContent:"center"},children:s.jsx(f,{to:"/",style:{textDecoration:"none",color:"inherit"},children:s.jsx(R,{})})}),s.jsx(j,{sx:{flexGrow:1,display:{xs:"none",md:"flex"},justifyContent:"center"},children:b.map(u=>s.jsx(E,{component:f,to:u.path,startIcon:u.icon,sx:{my:2,mx:1,color:r.pathname===u.path?"primary.main":"text.primary",backgroundColor:r.pathname===u.path?"action.selected":"transparent","&:hover":{backgroundColor:"action.hover"}},children:u.label},u.path))}),s.jsx(j,{sx:{flexGrow:0,display:"flex",alignItems:"center",gap:1},children:t?s.jsxs(s.Fragment,{children:[s.jsx(Te,{title:"Меню пользователя",children:s.jsx(Y,{onClick:L,children:s.jsx(Fe,{alt:t.name,src:t.avatar,sx:{width:40,height:40},children:!t.avatar&&t.name?t.name[0].toUpperCase():s.jsx(W,{})})})}),s.jsxs(Be,{sx:{mt:"45px"},id:"menu-appbar",anchorEl:i,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:!!i,onClose:_,children:[ce.map(u=>s.jsxs(J,{component:f,to:u.path,onClick:_,selected:r.pathname===u.path,children:[s.jsx(S,{children:u.icon}),s.jsx(X,{children:u.label})]},u.path)),s.jsx(Ne,{}),s.jsxs(J,{onClick:A,children:[s.jsx(S,{children:s.jsx($e,{})}),s.jsx(X,{children:"Выйти"})]})]})]}):s.jsxs(s.Fragment,{children:[s.jsx(E,{component:f,to:"/login",variant:"outlined",color:"primary",size:"small",children:"Войти"}),s.jsx(E,{component:f,to:"/register",variant:"contained",color:"primary",size:"small",children:"Регистрация"})]})})]})})})}function Ze(){return s.jsx("footer",{className:"bg-gray-800 text-white",children:s.jsxs("div",{className:"container mx-auto px-4 py-8",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"О компании"}),s.jsx("p",{className:"text-gray-300 text-sm",children:"GameGold - ваш надежный магазин цифровых копий игр. Мы предлагаем широкий выбор игр по доступным ценам."})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Быстрые ссылки"}),s.jsxs("ul",{className:"space-y-2",children:[s.jsx("li",{children:s.jsx(f,{to:"/games",className:"text-gray-300 hover:text-white transition-colors",children:"Каталог игр"})}),s.jsx("li",{children:s.jsx(f,{to:"/contact",className:"text-gray-300 hover:text-white transition-colors",children:"Контакты"})}),s.jsx("li",{children:s.jsx(f,{to:"/profile",className:"text-gray-300 hover:text-white transition-colors",children:"Личный кабинет"})})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Поддержка"}),s.jsxs("ul",{className:"space-y-2",children:[s.jsx("li",{children:s.jsx("a",{href:"#",className:"text-gray-300 hover:text-white transition-colors",children:"FAQ"})}),s.jsx("li",{children:s.jsx("a",{href:"#",className:"text-gray-300 hover:text-white transition-colors",children:"Правила использования"})}),s.jsx("li",{children:s.jsx("a",{href:"#",className:"text-gray-300 hover:text-white transition-colors",children:"Политика конфиденциальности"})})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Контакты"}),s.jsxs("ul",{className:"space-y-2",children:[s.jsx("li",{className:"text-gray-300",children:"Email: support@gamegold.com"}),s.jsx("li",{className:"text-gray-300",children:"Телефон: +7 (999) 123-45-67"})]})]})]}),s.jsx("div",{className:"border-t border-gray-700 mt-8 pt-8 text-center text-gray-300",children:s.jsxs("p",{children:["© ",new Date().getFullYear()," GameGold. Все права защищены."]})})]})})}function H(){return s.jsx(j,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px",children:s.jsx(qe,{})})}function er(){return s.jsxs(j,{sx:{display:"flex",flexDirection:"column",minHeight:"100vh",bgcolor:"background.default"},children:[s.jsx(Xe,{}),s.jsx(ne,{component:"main",sx:{flexGrow:1,py:4,px:{xs:2,sm:4},mt:{xs:2,sm:4}},maxWidth:"lg",children:s.jsx(p.Suspense,{fallback:s.jsx(H,{}),children:s.jsx(he,{})})}),s.jsx(Ze,{})]})}function m({children:a}){return s.jsx(p.Suspense,{fallback:s.jsx(H,{}),children:a})}function re({children:a}){const e=ae(),{initialized:r,isAuthenticated:n}=te(t=>t.auth);return p.useEffect(()=>{localStorage.getItem("token")&&!r?e(I()).unwrap().catch(()=>{localStorage.removeItem("token"),e(ee(!0))}):r||e(ee(!0))},[e,r]),r?a:s.jsx("div",{className:"flex justify-center items-center min-h-screen",children:s.jsx(H,{})})}const rr=p.lazy(()=>h(()=>import("./Login-M8CTQSZB.js"),__vite__mapDeps([0]))),sr=p.lazy(()=>h(()=>import("./Register-NVy8gYUp.js"),__vite__mapDeps([0]))),ar=p.lazy(()=>h(()=>import("./Home-Bs5NX6Up.js"),__vite__mapDeps([0]))),tr=p.lazy(()=>h(()=>import("./Profile-8B1l6_Re.js"),__vite__mapDeps([0]))),O=p.lazy(()=>h(()=>import("./ProtectedRoute-MBn-Tjsj.js"),__vite__mapDeps([0]))),nr=p.lazy(()=>h(()=>import("./AdminRoute-EW1QK9O2.js"),__vite__mapDeps([0]))),or=p.lazy(()=>h(()=>import("./Games-7FvqpE3M.js"),__vite__mapDeps([0]))),ir=p.lazy(()=>h(()=>import("./Contact-Dv-fZOI_.js"),__vite__mapDeps([0]))),lr=p.lazy(()=>h(()=>import("./Cart-DI-oad3l.js"),__vite__mapDeps([0]))),dr=p.lazy(()=>h(()=>import("./Orders-aYF9w2wm.js"),__vite__mapDeps([0]))),cr=p.lazy(()=>h(()=>import("./Dashboard-BEBXfF6I.js"),__vite__mapDeps([0]))),ur=p.lazy(()=>h(()=>import("./Users-BTh9f2Kk.js"),__vite__mapDeps([0]))),pr=p.lazy(()=>h(()=>import("./Orders-DujTPBxD.js"),__vite__mapDeps([0]))),gr=p.lazy(()=>h(()=>import("./Catalog-DCF5pVuX.js"),__vite__mapDeps([0]))),hr=p.lazy(()=>h(()=>import("./GameKeys-C0yk89hj.js"),__vite__mapDeps([0]))),mr=p.lazy(()=>h(()=>import("./Settings-BzMCbY4o.js"),__vite__mapDeps([0]))),xr=p.lazy(()=>h(()=>import("./AdminLayout-DnnvULjF.js"),__vite__mapDeps([0]))),fr=me([{path:"/",element:s.jsx(m,{children:s.jsx(er,{})}),children:[{index:!0,element:s.jsx(m,{children:s.jsx(ar,{})})},{path:"games",element:s.jsx(m,{children:s.jsx(or,{})})},{path:"contact",element:s.jsx(m,{children:s.jsx(ir,{})})},{path:"login",element:s.jsx(m,{children:s.jsx(re,{children:s.jsx(rr,{})})})},{path:"register",element:s.jsx(m,{children:s.jsx(re,{children:s.jsx(sr,{})})})},{path:"profile",element:s.jsx(O,{children:s.jsx(m,{children:s.jsx(tr,{})})})},{path:"cart",element:s.jsx(O,{children:s.jsx(m,{children:s.jsx(lr,{})})})},{path:"orders",element:s.jsx(O,{children:s.jsx(m,{children:s.jsx(dr,{})})})},{path:"admin",element:s.jsx(nr,{children:s.jsx(m,{children:s.jsx(xr,{})})}),children:[{path:"dashboard",element:s.jsx(m,{children:s.jsx(cr,{})})},{path:"users",element:s.jsx(m,{children:s.jsx(ur,{})})},{path:"orders",element:s.jsx(m,{children:s.jsx(pr,{})})},{path:"catalog",element:s.jsx(m,{children:s.jsx(gr,{})})},{path:"game-keys",element:s.jsx(m,{children:s.jsx(hr,{})})},{path:"settings",element:s.jsx(m,{children:s.jsx(mr,{})})}]},{path:"*",element:s.jsx(xe,{to:"/",replace:!0})}]}]),yr={items:[],totalAmount:0,totalQuantity:0},ie=C({name:"cart",initialState:yr,reducers:{addToCart:(a,e)=>{const r=e.payload;if(a.items.find(t=>t.id===r.id)){c.info("Игра уже в корзине");return}a.items.push({...r,quantity:1,total:r.price}),a.totalQuantity++,a.totalAmount+=r.price,c.success("Игра добавлена в корзину")},updateQuantity:(a,e)=>{const{id:r,quantity:n}=e.payload,t=a.items.find(i=>i.id===r);if(t){const i=n-t.quantity;t.quantity=n,t.total=t.price*n,a.totalQuantity+=i,a.totalAmount+=t.price*i,c.success("Количество обновлено")}},removeFromCart:(a,e)=>{const r=e.payload;a.items.find(t=>t.id===r)&&(a.items=a.items.filter(t=>t.id!==r),a.totalQuantity--,a.totalAmount=a.items.reduce((t,i)=>t+i.total,0),c.success("Игра удалена из корзины"))},clearCart:a=>{a.items=[],a.totalQuantity=0,a.totalAmount=0,c.success("Корзина очищена")}}}),{addToCart:Br,removeFromCart:Nr,clearCart:$r,updateQuantity:Gr}=ie.actions,jr=ie.reducer,se={games:[],game:null,isLoading:!1,error:null,filters:{search:"",genre:"",platform:"",priceRange:[0,1e4],sortBy:"createdAt",sortOrder:"desc"},pagination:{page:1,limit:12,total:0}},z=g("games/fetchGames",async({page:a=1,limit:e=12,filters:r={}},{rejectWithValue:n})=>{var t,i;try{const o={page:a,limit:e,...r};o.priceRange&&(o.minPrice=o.priceRange[0],o.maxPrice=o.priceRange[1],delete o.priceRange);const d=await l.get("/games",{params:o});if(!d.data.success)throw new Error(d.data.message||"Failed to fetch games");return{games:d.data.data,total:d.data.total||d.data.data.length,page:a,limit:e}}catch(o){return n(((i=(t=o.response)==null?void 0:t.data)==null?void 0:i.message)||o.message||"Ошибка загрузки игр")}}),D=g("games/fetchGameById",async(a,{rejectWithValue:e})=>{var r,n;try{const t=await l.get(`/games/${a}`);if(!t.data.success)throw new Error(t.data.message||"Failed to fetch game");return t.data.data}catch(t){return e(((n=(r=t.response)==null?void 0:r.data)==null?void 0:n.message)||t.message||"Ошибка загрузки игры")}}),le=C({name:"games",initialState:se,reducers:{setFilters:(a,e)=>{a.filters={...a.filters,...e.payload}},setPage:(a,e)=>{a.pagination.page=e.payload},resetFilters:a=>{a.filters=se.filters,a.pagination.page=1},clearGameDetails:a=>{a.game=null}},extraReducers:a=>{a.addCase(z.pending,e=>{e.isLoading=!0,e.error=null}).addCase(z.fulfilled,(e,r)=>{e.isLoading=!1,e.games=r.payload.games,e.pagination={...e.pagination,page:r.payload.page,limit:r.payload.limit,total:r.payload.total}}).addCase(z.rejected,(e,r)=>{e.isLoading=!1,e.error=r.payload||"Ошибка загрузки игр"}).addCase(D.pending,e=>{e.isLoading=!0,e.error=null}).addCase(D.fulfilled,(e,r)=>{e.isLoading=!1,e.game=r.payload}).addCase(D.rejected,(e,r)=>{e.isLoading=!1,e.error=r.payload||"Ошибка загрузки игры"})}}),{setFilters:Ur,setPage:Vr,resetFilters:Mr,clearGameDetails:qr}=le.actions,Lr=le.reducer,Cr={orders:[],order:null,isLoading:!1,error:null,pagination:{page:1,limit:10,total:0}},T=g("orders/fetchOrders",async({page:a,limit:e},{rejectWithValue:r})=>{var n,t;try{return(await l.get("/orders",{params:{page:a,limit:e}})).data}catch(i){return r(((t=(n=i.response)==null?void 0:n.data)==null?void 0:t.message)||"Ошибка загрузки заказов")}}),F=g("orders/fetchOrderById",async(a,{rejectWithValue:e})=>{var r,n;try{return(await l.get(`/orders/${a}`)).data}catch(t){return e(((n=(r=t.response)==null?void 0:r.data)==null?void 0:n.message)||"Ошибка загрузки заказа")}}),B=g("orders/createOrder",async(a,{rejectWithValue:e})=>{var r,n,t,i;try{const o=await l.post("/orders",a);return c.success("Заказ успешно создан"),o.data}catch(o){return c.error(((n=(r=o.response)==null?void 0:r.data)==null?void 0:n.message)||"Ошибка создания заказа"),e(((i=(t=o.response)==null?void 0:t.data)==null?void 0:i.message)||"Ошибка создания заказа")}}),N=g("orders/updateOrderStatus",async({id:a,status:e},{rejectWithValue:r})=>{var n,t,i,o;try{const d=await l.patch(`/orders/${a}/status`,{status:e});return c.success("Статус заказа обновлен"),d.data}catch(d){return c.error(((t=(n=d.response)==null?void 0:n.data)==null?void 0:t.message)||"Ошибка обновления статуса"),r(((o=(i=d.response)==null?void 0:i.data)==null?void 0:o.message)||"Ошибка обновления статуса")}}),_r=C({name:"orders",initialState:Cr,reducers:{setPage:(a,e)=>{a.pagination.page=e.payload},clearOrderDetails:a=>{a.order=null}},extraReducers:a=>{a.addCase(T.pending,e=>{e.isLoading=!0,e.error=null}).addCase(T.fulfilled,(e,r)=>{e.isLoading=!1,e.orders=r.payload.orders,e.pagination.total=r.payload.total}).addCase(T.rejected,(e,r)=>{e.isLoading=!1,e.error=r.payload}).addCase(F.pending,e=>{e.isLoading=!0,e.error=null}).addCase(F.fulfilled,(e,r)=>{e.isLoading=!1,e.order=r.payload}).addCase(F.rejected,(e,r)=>{e.isLoading=!1,e.error=r.payload}).addCase(B.pending,e=>{e.isLoading=!0,e.error=null}).addCase(B.fulfilled,(e,r)=>{e.isLoading=!1,e.orders.unshift(r.payload)}).addCase(B.rejected,(e,r)=>{e.isLoading=!1,e.error=r.payload}).addCase(N.pending,e=>{e.isLoading=!0,e.error=null}).addCase(N.fulfilled,(e,r)=>{var t;e.isLoading=!1;const n=e.orders.findIndex(i=>i.id===r.payload.id);n!==-1&&(e.orders[n]=r.payload),((t=e.order)==null?void 0:t.id)===r.payload.id&&(e.order=r.payload)}).addCase(N.rejected,(e,r)=>{e.isLoading=!1,e.error=r.payload})}}),br=_r.reducer,wr={users:[],user:null,isLoading:!1,error:null,pagination:{page:1,limit:10,total:0}},$=g("users/fetchUsers",async({page:a,limit:e},{rejectWithValue:r})=>{var n,t;try{return(await l.get("/users",{params:{page:a,limit:e}})).data}catch(i){return r(((t=(n=i.response)==null?void 0:n.data)==null?void 0:t.message)||"Ошибка загрузки пользователей")}}),G=g("users/fetchUserById",async(a,{rejectWithValue:e})=>{var r,n;try{return(await l.get(`/users/${a}`)).data}catch(t){return e(((n=(r=t.response)==null?void 0:r.data)==null?void 0:n.message)||"Ошибка загрузки пользователя")}}),U=g("users/updateUser",async({id:a,userData:e},{rejectWithValue:r})=>{var n,t,i,o;try{const d=await l.patch(`/users/${a}`,e);return c.success("Данные пользователя обновлены"),d.data}catch(d){return c.error(((t=(n=d.response)==null?void 0:n.data)==null?void 0:t.message)||"Ошибка обновления пользователя"),r(((o=(i=d.response)==null?void 0:i.data)==null?void 0:o.message)||"Ошибка обновления пользователя")}}),V=g("users/deleteUser",async(a,{rejectWithValue:e})=>{var r,n,t,i;try{return await l.delete(`/users/${a}`),c.success("Пользователь удален"),a}catch(o){return c.error(((n=(r=o.response)==null?void 0:r.data)==null?void 0:n.message)||"Ошибка удаления пользователя"),e(((i=(t=o.response)==null?void 0:t.data)==null?void 0:i.message)||"Ошибка удаления пользователя")}}),Ir=C({name:"users",initialState:wr,reducers:{setPage:(a,e)=>{a.pagination.page=e.payload},clearUserDetails:a=>{a.user=null}},extraReducers:a=>{a.addCase($.pending,e=>{e.isLoading=!0,e.error=null}).addCase($.fulfilled,(e,r)=>{e.isLoading=!1,e.users=r.payload.users,e.pagination.total=r.payload.total}).addCase($.rejected,(e,r)=>{e.isLoading=!1,e.error=r.payload}).addCase(G.pending,e=>{e.isLoading=!0,e.error=null}).addCase(G.fulfilled,(e,r)=>{e.isLoading=!1,e.user=r.payload}).addCase(G.rejected,(e,r)=>{e.isLoading=!1,e.error=r.payload}).addCase(U.pending,e=>{e.isLoading=!0,e.error=null}).addCase(U.fulfilled,(e,r)=>{var t;e.isLoading=!1;const n=e.users.findIndex(i=>i.id===r.payload.id);n!==-1&&(e.users[n]=r.payload),((t=e.user)==null?void 0:t.id)===r.payload.id&&(e.user=r.payload)}).addCase(U.rejected,(e,r)=>{e.isLoading=!1,e.error=r.payload}).addCase(V.pending,e=>{e.isLoading=!0,e.error=null}).addCase(V.fulfilled,(e,r)=>{var n;e.isLoading=!1,e.users=e.users.filter(t=>t.id!==r.payload),((n=e.user)==null?void 0:n.id)===r.payload&&(e.user=null)}).addCase(V.rejected,(e,r)=>{e.isLoading=!1,e.error=r.payload})}}),Ar=Ir.reducer,de={getSettings:async()=>(await l.get("/settings")).data,updateSettings:async a=>(await l.put("/settings",a)).data},M=g("settings/fetchSettings",async(a,{rejectWithValue:e})=>{var r,n;try{return await de.getSettings()}catch(t){return e(((n=(r=t.response)==null?void 0:r.data)==null?void 0:n.message)||"Ошибка загрузки настроек")}}),q=g("settings/updateSettings",async(a,{rejectWithValue:e})=>{var r,n;try{return await de.updateSettings(a)}catch(t){return e(((n=(r=t.response)==null?void 0:r.data)==null?void 0:n.message)||"Ошибка обновления настроек")}}),Sr={settings:null,isLoading:!1,error:null,isInitialized:!1},Er=C({name:"settings",initialState:Sr,reducers:{clearError:a=>{a.error=null}},extraReducers:a=>{a.addCase(M.pending,e=>{e.isLoading=!0,e.error=null}).addCase(M.fulfilled,(e,r)=>{e.isLoading=!1,e.settings=r.payload,e.error=null,e.isInitialized=!0}).addCase(M.rejected,(e,r)=>{e.isLoading=!1,e.error=r.payload,e.isInitialized=!0}).addCase(q.pending,e=>{e.isLoading=!0,e.error=null}).addCase(q.fulfilled,(e,r)=>{e.isLoading=!1,e.settings=r.payload,e.error=null}).addCase(q.rejected,(e,r)=>{e.isLoading=!1,e.error=r.payload})}}),kr=Er.reducer,vr=_e({reducer:{auth:Ye,cart:jr,games:Lr,orders:br,users:Ar,settings:kr},middleware:a=>a({serializableCheck:{ignoredActions:["auth/login/fulfilled","auth/register/fulfilled","auth/checkStatus/fulfilled"],ignoredPaths:["auth.user","auth.error"]}})});fe.createRoot(document.getElementById("root")).render(s.jsx(ye.StrictMode,{children:s.jsxs(je,{store:vr,children:[s.jsx(Le,{router:fr}),s.jsx(Ce,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!0,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"})]})}));export{H as L,Ur as a,Br as b,Gr as c,Nr as d,$r as e,z as f,T as g,l as h,Tr as i,M as j,q as k,P as l,de as m,R as n,Dr as p,v as r,Vr as s,k as u};
