import{j as e,B as c,m as I,g as y,_ as N,P as O,$ as V,a0 as F,a1 as D,a2 as r,a3 as H,I as K,a6 as Z,a7 as _,a8 as q,w as Q,x as J,y as U,l as X,r as S,a9 as Y}from"./ui-vendor-BekXbpvv.js";import{r as t}from"./react-vendor-CmdBDJ7C.js";import{p as ee,i as k,Q as d}from"./index-DbOi_nDC.js";import"./redux-vendor-D-krhjMU.js";import"./utils-upsvKRUO.js";/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var se={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=o=>o.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),f=(o,w)=>{const p=t.forwardRef(({color:b="currentColor",size:u=24,strokeWidth:j=2,absoluteStrokeWidth:v,className:h="",children:i,...m},l)=>t.createElement("svg",{ref:l,...se,width:u,height:u,stroke:b,strokeWidth:v?Number(j)*24/Number(u):j,className:["lucide",`lucide-${ae(o)}`,h].join(" "),...m},[...w.map(([x,g])=>t.createElement(x,g)),...Array.isArray(i)?i:[i]]));return p.displayName=`${o}`,p};/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=f("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=f("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=f("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=f("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);function de(){const[o,w]=t.useState([]),[p,b]=t.useState([]),[u,j]=t.useState(!0),[v,h]=t.useState(!1),[i,m]=t.useState(""),[l,x]=t.useState([{login:"",password:""}]),[g,P]=t.useState({});t.useEffect(()=>{C()},[]);const C=async()=>{try{j(!0);const[s,a]=await Promise.all([ee.getGames(),k.getAllKeys()]);w(s||[]),b(a||[])}catch(s){console.error("Error fetching data:",s),d.error("Ошибка при загрузке данных")}finally{j(!1)}},z=()=>{x([...l,{login:"",password:""}])},B=s=>{x(l.filter((a,n)=>n!==s))},A=(s,a,n)=>{const R=l.map((E,$)=>$===s?{...E,[a]:n}:E);x(R)},G=async()=>{try{if(!i){d.error("Выберите игру");return}if(l.some(a=>!a.login||!a.password)){d.error("Заполните все поля для ключей");return}await k.addKeys(i,l),d.success("Ключи успешно добавлены"),h(!1),m(""),x([{login:"",password:""}]),C()}catch(s){console.error("Error adding keys:",s),d.error("Ошибка при добавлении ключей")}},L=async s=>{try{await k.deleteKey(s),d.success("Ключ успешно удален"),C()}catch(a){console.error("Error deleting key:",a),d.error("Ошибка при удалении ключа")}},W=s=>{P(a=>({...a,[s]:!a[s]}))};return u?e.jsx(c,{sx:{p:3,textAlign:"center"},children:e.jsx(I,{children:"Загрузка..."})}):e.jsxs(c,{sx:{p:3},children:[e.jsxs(c,{sx:{mb:3,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(I,{variant:"h5",children:"Управление ключами"}),e.jsx(y,{variant:"contained",startIcon:e.jsx(T,{}),onClick:()=>h(!0),children:"Добавить ключи"})]}),e.jsx(N,{component:O,children:e.jsxs(V,{children:[e.jsx(F,{children:e.jsxs(D,{children:[e.jsx(r,{children:"ID"}),e.jsx(r,{children:"Игра"}),e.jsx(r,{children:"Логин"}),e.jsx(r,{children:"Пароль"}),e.jsx(r,{children:"Статус"}),e.jsx(r,{children:"Действия"})]})}),e.jsx(H,{children:p.map(s=>{var a;return e.jsxs(D,{children:[e.jsx(r,{children:s.id}),e.jsx(r,{children:((a=o.find(n=>n.id===s.gameId))==null?void 0:a.title)||"Неизвестная игра"}),e.jsx(r,{children:s.login}),e.jsx(r,{children:e.jsxs(c,{sx:{display:"flex",alignItems:"center",gap:1},children:[g[s.id]?s.password:"••••••••",e.jsx(K,{size:"small",onClick:()=>W(s.id),children:g[s.id]?e.jsx(re,{size:16}):e.jsx(te,{size:16})})]})}),e.jsx(r,{children:e.jsx(c,{component:"span",sx:{px:1,py:.5,borderRadius:1,backgroundColor:s.status==="available"?"success.light":"warning.light",color:"white"},children:s.status==="available"?"Доступен":"Зарезервирован"})}),e.jsx(r,{children:e.jsx(K,{color:"error",onClick:()=>L(s.id),disabled:s.status!=="available",children:e.jsx(M,{size:16})})})]},s.id)})})]})}),e.jsxs(Z,{open:v,onClose:()=>h(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(_,{children:"Добавить ключи"}),e.jsx(q,{children:e.jsxs(c,{sx:{mt:2},children:[e.jsxs(Q,{fullWidth:!0,sx:{mb:2},children:[e.jsx(J,{children:"Игра"}),e.jsx(U,{value:i,onChange:s=>m(s.target.value),label:"Игра",children:o.map(s=>e.jsx(X,{value:s.id,children:s.title},s.id))})]}),l.map((s,a)=>e.jsxs(c,{sx:{mb:2,display:"flex",gap:1},children:[e.jsx(S,{label:"Логин",value:s.login,onChange:n=>A(a,"login",n.target.value),fullWidth:!0}),e.jsx(S,{label:"Пароль",value:s.password,onChange:n=>A(a,"password",n.target.value),fullWidth:!0}),e.jsx(K,{color:"error",onClick:()=>B(a),disabled:l.length===1,children:e.jsx(M,{size:16})})]},a)),e.jsx(y,{startIcon:e.jsx(T,{}),onClick:z,sx:{mt:1},children:"Добавить еще ключ"})]})}),e.jsxs(Y,{children:[e.jsx(y,{onClick:()=>h(!1),children:"Отмена"}),e.jsx(y,{onClick:G,variant:"contained",children:"Сохранить"})]})]})]})}export{de as default};
