import{j as p,r as x,R as m}from"./index-DwH2koU-.js";import{P as ce}from"./package-DTanlPbd.js";import{C as le}from"./clock-B3JtZbGA.js";import{M as pe}from"./map-pin-CSTaY3jG.js";function ue({status:r,estimatedTime:e}){return p.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[p.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Информация о заказе"}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex items-center",children:[p.jsx(ce,{className:"h-5 w-5 text-blue-600 mr-3"}),p.jsxs("div",{children:[p.jsx("p",{className:"font-medium",children:"Статус доставки"}),p.jsx("p",{className:"text-gray-600",children:r})]})]}),p.jsxs("div",{className:"flex items-center",children:[p.jsx(le,{className:"h-5 w-5 text-blue-600 mr-3"}),p.jsxs("div",{children:[p.jsx("p",{className:"font-medium",children:"Ожидаемое время доставки"}),p.jsxs("p",{className:"text-gray-600",children:["Примерно через ",e]})]})]}),p.jsxs("div",{className:"flex items-center",children:[p.jsx(pe,{className:"h-5 w-5 text-blue-600 mr-3"}),p.jsxs("div",{children:[p.jsx("p",{className:"font-medium",children:"Адрес доставки"}),p.jsx("p",{className:"text-gray-600",children:"ул. Тверская, д. 1, Москва"})]})]})]}),p.jsx("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:p.jsx("p",{className:"text-sm text-blue-800",children:"Курьер свяжется с вами за 15-20 минут до прибытия"})})]})}function E(){return E=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=t[s])}return r},E.apply(this,arguments)}const se=(r,e)=>{const t={};for(const s in r)e.indexOf(s)===-1&&(t[s]=r[s]);return t},ne=m.createContext(null),q=m.createContext(null),oe=r=>e=>m.createElement(q.Consumer,null,t=>m.createElement(r,E({parent:t},e))),de=(r=[])=>{const[e,t]=x.useState(!1),s=x.useRef(r),n=(()=>{const l=x.useContext(ne);if(l===null)throw new Error("Couldn't find Yandex.Maps API in the context. Make sure that hook useYMaps is inside <YMaps /> provider");return l})(),i=n.getApi();return x.useEffect(()=>{n.load().then(()=>Promise.all(s.current.map(n.loadModule))).then(()=>t(!0))},[]),e&&i?i:null},me=()=>{},he=["onLoad","onError","modules","apiLoader"];function W(r,e=!1,t=[]){return s=>{const{width:n,height:i,modules:l=[],onLoad:u=me}=s,a=de(t.concat(l)),o=!e||!!a,j=se(s,he);return x.useEffect(()=>a?u(a):void 0,[a]),o?m.createElement(r,E({ymaps:a},j)):m.createElement("div",{style:{width:n,height:i}})}}const fe=typeof window<"u",H={lang:"ru_RU",load:"",ns:"",mode:"release"},je=r=>{const{version:e="2.1",enterprise:t=!1,query:s={lang:"ru_RU",load:"",ns:""},preload:n=!1,children:i}=r,l=x.useRef((u=>{const{query:a=H}=u,o=Date.now().toString(32),j=a.ns||"",y="__yandex-maps-api-onload__$$"+o,b="__yandex-maps-api-onerror__$$"+o,v=fe?window:{},A={};let R;const J=()=>j?v[j]:R,Q=()=>{delete v[y],delete v[b]};return{load:()=>{if(J())return Promise.resolve(R);if(A[j])return A[j];const M={onload:y,onerror:b,...H,...a},B=Object.keys(M).map(_=>`${_}=${M[_]}`).join("&"),F=[`https://${u.enterprise?"enterprise.":""}api-maps.yandex.ru`,u.version,"?"+B].join("/");return A[j]=new Promise((_,V)=>{v[y]=g=>{Q(),g.ready(()=>{R=g,_(g)})},v[b]=g=>{Q(),V(g)},(g=>new Promise((k,Y)=>{const O=document.createElement("script");O.type="text/javascript",O.onload=k,O.onerror=Y,O.src=g,O.async=!0,document.head.appendChild(O)}))(F).catch(v[b])}),A[j]},getApi:J,loadModule:M=>new Promise((B,F)=>{R.modules.require(M).done(_=>{_.forEach(V=>{((g,k,Y,O=!1)=>{const G=typeof k=="string"?k.split("."):k.slice();let z,N=g;for(;G.length>1;)z=G.shift(),N[z]||(N[z]={}),N=N[z];const X=G[0];N[X]=O===!0&&N[X]||Y})(R,M,V,!0)}),B(R)},F)})}})({version:e,enterprise:t,query:s,preload:n}));return x.useEffect(()=>{n&&l.current.load()},[l.current]),m.createElement(ne.Provider,{value:l.current},i)},K=/^on(?=[A-Z])/;function d(r){return Object.keys(r).reduce((e,t)=>{if(K.test(t)){const s=t.replace(K,"").toLowerCase();e._events[s]=r[t]}else e[t]=r[t];return e},{_events:{}})}function w(r,e,t){typeof t=="function"&&r.events.add(e,t)}function C(r,e,t){typeof t=="function"&&r.events.remove(e,t)}function P(r,e,t){Object.keys(Object.assign({},e,t)).forEach(s=>{e[s]!==t[s]&&(C(r,s,e[s]),w(r,s,t[s]))})}const re=r=>"default"+r.charAt(0).toUpperCase()+r.slice(1);function h(r,e){return r[e]!==void 0||r[re(e)]===void 0}function c(r,e,t){return(h(r,e)?r[e]:r[re(e)])||t}function f(r,e,t=null){if(r!==e){if(r&&("current"in r?r.current=null:typeof r=="function"&&r(null)),!e)return;"current"in e?e.current=t:typeof e=="function"&&e(t)}}function ae(r){const{width:e,height:t,style:s,className:n}=r;return s!==void 0||n!==void 0?Object.assign({},s&&{style:s},n&&{className:n}):{style:{width:e,height:t}}}class ye extends m.Component{constructor(e){super(e),this.state={error:null,errorInfo:null}}componentDidCatch(e,t){const{onError:s=()=>{}}=this.props;s(e),this.setState({error:e,errorInfo:t})}render(){return this.state.error?null:this.props.children}}const L=r=>({onError:e,...t})=>m.createElement(ye,{onError:e},m.createElement(r,t));class D extends m.Component{constructor(){super(),this.instance=null,this.state={instance:null},this._parentElement=null,this._getRef=e=>{this._parentElement=e}}componentDidMount(){this.instance=D.mountObject(this._parentElement,this.props.ymaps.Map,this.props),this.setState({instance:this.instance})}componentDidUpdate(e){this.instance!==null&&D.updateObject(this.instance,e,this.props)}componentWillUnmount(){D.unmountObject(this.instance,this.props)}render(){const e=ae(this.props),t=d(this.props),s=se(t,["_events","state","defaultState","options","defaultOptions","instanceRef","ymaps","children","width","height","style","className"]);return m.createElement(q.Provider,{value:this.state.instance},m.createElement("div",E({ref:this._getRef},e,s),this.props.children))}static mountObject(e,t,s){const{instanceRef:n,_events:i}=d(s),l=new t(e,c(s,"state"),c(s,"options"));return Object.keys(i).forEach(u=>w(l,u,i[u])),f(null,n,l),l}static updateObject(e,t,s){const{_events:n,instanceRef:i}=d(s),{_events:l,instanceRef:u}=d(t);if(h(s,"state")){const a=c(t,"state",{}),o=c(s,"state",{});a.type!==o.type&&e.setType(o.type),a.behaviors!==o.behaviors&&(a.behaviors&&e.behaviors.disable(a.behaviors),o.behaviors&&e.behaviors.enable(o.behaviors)),o.zoom&&a.zoom!==o.zoom&&e.setZoom(o.zoom),o.center&&a.center!==o.center&&e.setCenter(o.center),o.bounds&&a.bounds!==o.bounds&&e.setBounds(o.bounds)}if(h(s,"options")){const a=c(t,"options"),o=c(s,"options",{});a!==o&&e.options.set(o)}c(t,"width")===c(s,"width")&&c(t,"height")===c(s,"height")||e.container.fitToViewport(),P(e,l,n),f(u,i,e)}static unmountObject(e,t){const{instanceRef:s,_events:n}=d(t);e!==null&&(Object.keys(n).forEach(i=>C(e,i,n[i])),e.destroy(),f(s))}}const ie=L(W(D,!0,["Map"]));ie.defaultProps={width:320,height:240};class T extends m.Component{constructor(){super(),this.state={instance:null},this._parentElement=null,this._getRef=e=>{this._parentElement=e}}componentDidMount(){this._mounted=!0,this.props.ymaps.panorama.isSupported()&&T.mountObject(this._parentElement,this.props.ymaps.panorama,this.props).then(e=>this._mounted&&this.setState({instance:e}))}componentDidUpdate(e){this.state.instance!==null&&T.updateObject(this.state.instance,e,this.props)}componentWillUnmount(){this._mounted=!1,T.unmountObject(this.state.instance,this.props)}render(){const e=ae(this.props);return m.createElement("div",E({ref:this._getRef},e))}static mountObject(e,t,s){const{instanceRef:n,_events:i}=d(s),l=c(s,"point"),u=c(s,"locateOptions"),a=c(s,"options");return new Promise((o,j)=>{t.locate(l,u).done(y=>{if(y.length>0){const b=new t.Player(e,y[0],a);f(null,n,b),Object.keys(i).forEach(v=>w(b,v,i[v])),o(b)}},j)})}static updateObject(e,t,s){const{_events:n,instanceRef:i}=d(s),{_events:l,instanceRef:u}=d(t);if(h(s,"options")){const a=c(t,"options"),o=c(s,"options");a!==o&&e.options.set(o)}if(h(s,"point")){const a=c(s,"point"),o=c(t,"point"),j=c(s,"locateOptions");a!==o&&e.moveTo(a,j)}P(e,l,n),f(u,i,e)}static unmountObject(e,t){const{instanceRef:s,_events:n}=d(t);e!==null&&(Object.keys(n).forEach(i=>C(e,i,n[i])),f(s))}}const be=L(W(T,!0,["panorama.isSupported","panorama.locate","panorama.createPlayer","panorama.Player"]));be.defaultProps={width:320,height:240};class U extends m.Component{constructor(){super(),this.state={instance:null},this.instance=null}componentDidMount(){const e=U.mountControl(this.props.ymaps.control[this.props.name],this.props);this.instance=e,this.setState({instance:e})}componentDidUpdate(e){this.instance!==null&&U.updateControl(this.instance,e,this.props)}componentWillUnmount(){U.unmountControl(this.instance,this.props)}render(){return m.createElement(q.Provider,{value:this.state.instance},this.props.children)}static mountControl(e,t){const{instanceRef:s,parent:n,lazy:i,_events:l}=d(t),u=new e({data:c(t,"data"),options:c(t,"options"),state:c(t,"state"),mapTypes:c(t,"mapTypes"),lazy:i});if(Object.keys(l).forEach(a=>w(u,a,l[a])),n&&n.controls&&typeof n.controls.add=="function")n.controls.add(u);else{if(!n||!n.add||typeof n.add!="function")throw new Error(`No parent found to mount ${t.name}`);n.add(u)}return f(null,s,u),u}static updateControl(e,t,s){const{_events:n,instanceRef:i}=d(s),{_events:l,instanceRef:u}=d(t);if(h(s,"options")){const a=c(t,"options"),o=c(s,"options");a!==o&&e.options.set(o)}if(h(s,"data")){const a=c(t,"data"),o=c(s,"data");a!==o&&e.data.set(o)}if(h(s,"state")){const a=c(t,"state"),o=c(s,"state");a!==o&&e.state.set(o)}if(h(s,"mapTypes")){const a=c(t,"mapTypes"),o=c(s,"mapTypes");a!==o&&(e.removeAllMapTypes(),o.forEach(j=>e.addMapType(j)))}P(e,l,n),f(u,i,e)}static unmountControl(e,t){const{instanceRef:s,parent:n,_events:i}=d(t);e!==null&&(Object.keys(i).forEach(l=>C(e,l,i[l])),n.controls&&typeof n.controls.remove=="function"?n.controls.remove(e):n.remove&&typeof n.remove=="function"&&n.remove(e),f(s))}}var ve=L(oe(W(r=>m.createElement(U,E({},r,{name:"ZoomControl"})),!0,["control.ZoomControl"])));class I extends m.Component{constructor(){super(),this.state={instance:null},this.instance=null}componentDidMount(){const e=I.mountObject(this.props.ymaps.Clusterer,this.props);this.instance=e,this.setState({instance:e})}componentDidUpdate(e){this.state.instance!==null&&I.updateObject(this.instance,e,this.props)}componentWillUnmount(){I.unmountObject(this.instance,this.props)}render(){return m.createElement(q.Provider,{value:this.state.instance},this.props.children)}static mountObject(e,t){const{instanceRef:s,parent:n,_events:i}=d(t),l=new e(c(t,"options"));if(Object.keys(i).forEach(u=>w(l,u,i[u])),n.geoObjects&&typeof n.geoObjects.add=="function")n.geoObjects.add(l);else{if(!n.add||typeof n.add!="function")throw new Error("No parent found to mount Clusterer");n.add(l)}return f(null,s,l),l}static updateObject(e,t,s){const{_events:n,instanceRef:i}=d(s),{_events:l,instanceRef:u}=d(t);if(h(s,"options")){const a=c(t,"options"),o=c(s,"options");a!==o&&e.options.set(o)}P(e,l,n),f(u,i,e)}static unmountObject(e,t){const{instanceRef:s,parent:n,_events:i}=d(t);e!==null&&(Object.keys(i).forEach(l=>C(e,l,i[l])),n.geoObjects&&typeof n.geoObjects.remove=="function"?n.geoObjects.remove(e):n.remove&&typeof n.remove=="function"&&n.remove(e),f(s))}}class $ extends m.Component{constructor(){super(),this.state={instance:null}}componentDidMount(){const e=$.mountObject(this.props.ymaps.ObjectManager,this.props);this.instance=e,this.setState({instance:e})}componentDidUpdate(e){this.instance!==null&&$.updateObject(this.instance,e,this.props)}componentWillUnmount(){$.unmountObject(this.instance,this.props)}render(){return null}static mountObject(e,t){const{instanceRef:s,parent:n,_events:i}=d(t),l=c(t,"options",{}),u=c(t,"features",{}),a=c(t,"filter",null),o=c(t,"objects",{}),j=c(t,"clusters",{}),y=new e(l);if(y.add(u||[]),y.setFilter(a),y.objects.options.set(o),y.clusters.options.set(j),Object.keys(i).forEach(b=>w(y,b,i[b])),n.geoObjects&&typeof n.geoObjects.add=="function")n.geoObjects.add(y);else{if(!n.add||typeof n.add!="function")throw new Error("No parent found to mount ObjectManager");n.add(y)}return f(null,s,y),y}static updateObject(e,t,s){const{_events:n,instanceRef:i}=d(s),{_events:l,instanceRef:u}=d(t);if(h(s,"options")){const a=c(t,"options"),o=c(s,"options");a!==o&&e.options.set(o)}if(h(s,"objects")){const a=c(t,"objects"),o=c(s,"objects");a!==o&&e.objects.options.set(o)}if(h(s,"clusters")){const a=c(t,"clusters"),o=c(s,"clusters");a!==o&&e.clusters.options.set(o)}if(h(s,"filter")){const a=c(t,"filter"),o=c(s,"filter");a!==o&&e.setFilter(o)}if(h(s,"features")){const a=c(t,"features"),o=c(s,"features");a!==o&&(e.remove(a),e.add(o))}P(e,l,n),f(u,i,e)}static unmountObject(e,t){const{instanceRef:s,parent:n,_events:i}=d(t);e!==null&&(Object.keys(i).forEach(l=>C(e,l,i[l])),n.geoObjects&&typeof n.geoObjects.remove=="function"?n.geoObjects.remove(e):n.remove&&typeof n.remove=="function"&&n.remove(e),f(s))}}class S extends m.Component{constructor(){super(),this.state={instance:null},this.instance=null}componentDidMount(){const{name:e,ymaps:t,dangerZone:s}=this.props,n=S.mountObject(s&&typeof s.modifyConstructor=="function"?s.modifyConstructor(t[e]):t[e],this.props);this.instance=n,this.setState({instance:n})}componentDidUpdate(e){this.instance!==null&&S.updateObject(this.instance,e,this.props)}componentWillUnmount(){S.unmountObject(this.instance,this.props)}render(){return null}static mountObject(e,t){const{instanceRef:s,parent:n,_events:i}=d(t),l=new e(c(t,"geometry"),c(t,"properties"),c(t,"options"));if(Object.keys(i).forEach(u=>w(l,u,i[u])),n&&n.geoObjects&&typeof n.geoObjects.add=="function")n.geoObjects.add(l);else{if(!n||!n.add||typeof n.add!="function")throw new Error(`No parent found to mount ${t.name}`);n.add(l)}return f(null,s,l),l}static updateObject(e,t,s){const{_events:n,instanceRef:i}=d(s),{_events:l,instanceRef:u}=d(t);if(h(s,"geometry")){const a=c(t,"geometry",{}),o=c(s,"geometry",{});Array.isArray(o)&&o!==a?Array.isArray(o[0])&&typeof o[1]=="number"?(e.geometry.setCoordinates(o[0]),e.geometry.setRadius(o[1])):e.geometry.setCoordinates(o):typeof o=="object"&&(o.coordinates!==a.coordinates&&e.geometry.setCoordinates(o.coordinates),o.radius!==a.radius&&e.geometry.setRadius(o.radius))}if(h(s,"properties")){const a=c(t,"properties"),o=c(s,"properties");a!==o&&e.properties.set(o)}if(h(s,"options")){const a=c(t,"options"),o=c(s,"options");a!==o&&e.options.set(o)}P(e,l,n),f(u,i,e)}static unmountObject(e,t){const{instanceRef:s,parent:n,_events:i}=d(t);e!==null&&(Object.keys(i).forEach(l=>C(e,l,i[l])),n.geoObjects&&typeof n.geoObjects.remove=="function"?n.geoObjects.remove(e):n.remove&&typeof n.remove=="function"&&n.remove(e),f(s))}}var ge=L(oe(W(r=>m.createElement(S,E({},r,{name:"Placemark"})),!0,["Placemark"])));const ee=({geometry:r,preset:e,iconColor:t})=>r?p.jsx(ge,{geometry:r,options:{preset:e,iconColor:t}}):null,xe=({position:r})=>p.jsx(ve,{options:{position:r}}),te={courier:{preset:"islands#deliveryIcon",iconColor:"#2563eb"},destination:{preset:"islands#dotIcon",iconColor:"#2563eb"}},Oe={zoom:{position:{right:10,top:10}}},Z={defaultCenter:[51.1798,71.4451],defaultZoom:12,language:"ru_RU"},Ee=({courierLocation:r,deliveryAddress:e})=>{const t=m.useMemo(()=>({center:r||Z.defaultCenter,zoom:Z.defaultZoom,controls:[]}),[r]),s=m.useMemo(()=>({suppressMapOpenBlock:!0,yandexMapDisablePoiInteractivity:!0}),[]);return p.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:p.jsx("div",{className:"h-[500px]",children:p.jsx(je,{query:{lang:Z.language},children:p.jsxs(ie,{state:t,width:"100%",height:"100%",options:s,children:[p.jsx(ee,{geometry:r,...te.courier}),p.jsx(ee,{geometry:e,...te.destination}),p.jsx(xe,{...Oe.zoom})]})})})})},we=()=>new Promise(r=>{setTimeout(()=>{r({coordinates:[55.751244,37.618423],status:"В пути",estimatedTime:"25 минут"})},1e3)}),Pe=()=>{const[r,e]=x.useState(null),t=Z.defaultCenter;return x.useEffect(()=>{const s=async()=>{try{const i=await we();e(i)}catch(i){console.error("Ошибка при получении местоположения курьера:",i)}};s();const n=setInterval(s,3e4);return()=>clearInterval(n)},[]),r?p.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8 sm:px-6 lg:px-8",children:[p.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Отслеживание доставки"}),p.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[p.jsx("div",{className:"lg:col-span-1",children:p.jsx(ue,{status:r.status,estimatedTime:r.estimatedTime})}),p.jsx("div",{className:"lg:col-span-2",children:p.jsx(Ee,{courierLocation:r.coordinates,deliveryAddress:t})})]})]}):p.jsx("div",{className:"flex justify-center items-center min-h-screen",children:p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})};export{Pe as default};
