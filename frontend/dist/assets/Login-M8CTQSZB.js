import{r as y,j as e,L as j,l as v,u as C,i as D,m as S}from"./react-vendor-BB4BkCfL.js";import{B as w,s as L,t as g,v as k,I as F,V as I,w as P,F as N,x as B,g as G,r as W,G as p,l as f,C as A,y as E}from"./mui-vendor-QnVK6N-v.js";import{l as V}from"./index-DpTN90_E.js";import"./vendor-Dh_iZ00o.js";import"./redux-vendor-56JQh752.js";const q=({formData:r,isLoading:t,error:o,onChange:s,onSubmit:i})=>{const[n,u]=y.useState(!1),b=()=>{u(!n)};return e.jsxs(w,{component:"form",onSubmit:i,sx:{mt:3,width:"100%"},children:[o&&e.jsx(L,{severity:"error",sx:{mb:2},children:o}),e.jsx(g,{margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email",name:"email",autoComplete:"email",autoFocus:!0,value:r.email,onChange:s,disabled:t}),e.jsx(g,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Пароль",type:n?"text":"password",id:"password",autoComplete:"current-password",value:r.password,onChange:s,disabled:t,InputProps:{endAdornment:e.jsx(k,{position:"end",children:e.jsx(F,{"aria-label":"toggle password visibility",onClick:b,edge:"end",children:n?e.jsx(I,{}):e.jsx(P,{})})})}}),e.jsx(N,{control:e.jsx(B,{name:"remember",checked:r.remember,onChange:s,color:"primary",disabled:t}),label:"Запомнить меня"}),e.jsx(G,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},disabled:t,children:t?e.jsx(W,{size:24,color:"inherit"}):"Войти"}),e.jsxs(p,{container:!0,children:[e.jsx(p,{item:!0,xs:!0,children:e.jsx(j,{to:"/forgot-password",children:e.jsx(f,{variant:"body2",color:"primary",sx:{textDecoration:"none","&:hover":{textDecoration:"underline"}},children:"Забыли пароль?"})})}),e.jsx(p,{item:!0,children:e.jsx(j,{to:"/register",children:e.jsx(f,{variant:"body2",color:"primary",sx:{textDecoration:"none","&:hover":{textDecoration:"underline"}},children:"Нет аккаунта? Зарегистрируйтесь"})})})]})]})},H=()=>e.jsxs("div",{children:[e.jsx("img",{className:"mx-auto h-12 w-auto",src:"/game-controller.svg",alt:"GameGold Logo"}),e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Войти в аккаунт"}),e.jsxs("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Или"," ",e.jsx(j,{to:"/register",className:"font-medium text-blue-600 hover:text-blue-500",children:"зарегистрируйтесь"}),", если у вас еще нет аккаунта"]})]}),R=()=>{const r=v(),t=C(),o=D(),{isLoading:s,error:i}=S(l=>l.auth),[n,u]=y.useState({email:"",password:"",remember:!1});return{formData:n,isLoading:s,error:i,handleChange:l=>{const{name:c,value:d,type:m,checked:a}=l.target;u(h=>({...h,[c]:m==="checkbox"?a:d}))},handleSubmit:async l=>{var c,d,m;l.preventDefault();try{const a=await r(V(n)).unwrap();if(a.success&&((c=a.data)!=null&&c.user)){const{user:h}=a.data,x=(m=(d=o.state)==null?void 0:d.from)==null?void 0:m.pathname;h.role==="admin"&&(!x||x==="/")?t("/admin/dashboard",{replace:!0}):x?t(x,{replace:!0}):t("/",{replace:!0})}}catch(a){console.error("Login error:",a)}}}},Q=()=>{const{formData:r,isLoading:t,error:o,handleChange:s,handleSubmit:i}=R();return e.jsx(A,{component:"main",maxWidth:"xs",children:e.jsx(w,{sx:{minHeight:"calc(100vh - 64px)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",py:4},children:e.jsxs(E,{elevation:3,sx:{p:4,width:"100%",display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(H,{}),e.jsx(q,{formData:r,isLoading:t,error:o,onChange:s,onSubmit:i})]})})})};export{Q as default};
