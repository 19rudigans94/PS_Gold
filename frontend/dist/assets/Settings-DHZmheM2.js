import{j as e,h as P,l as q,m as N,r as v,B as f}from"./react-vendor-DJDP48A3.js";import{j as M,k as U,m as L,L as D}from"./index-BHnZzIva.js";import{B as j,G as s,t as n,g as p,F as x,al as h,v as O,I as B,V as R,w as F,z as w,E as k,J as E,k as m,am as G,W as V,C as _,l as z,y as T,an as H,ao as y,ap as J,aq as Q,ar as Y,as as $,at as K}from"./mui-vendor-Dc8Krwhl.js";import"./vendor-CNMAvAG4.js";import"./redux-vendor-DRW7Cx4S.js";const X=({settings:a,onChange:r,onSave:i})=>e.jsx(j,{children:e.jsxs(s,{container:!0,spacing:3,children:[e.jsx(s,{item:!0,xs:12,children:e.jsx(n,{fullWidth:!0,label:"Название сайта",value:a.siteName,onChange:t=>r("general","siteName",t.target.value)})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(n,{fullWidth:!0,multiline:!0,rows:4,label:"Описание",value:a.description,onChange:t=>r("general","description",t.target.value)})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,label:"Email для связи",type:"email",value:a.contactEmail,onChange:t=>r("general","contactEmail",t.target.value)})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,label:"Номер телефона",value:a.phoneNumber,onChange:t=>r("general","phoneNumber",t.target.value)})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(n,{fullWidth:!0,label:"Адрес",value:a.address,onChange:t=>r("general","address",t.target.value)})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(p,{variant:"contained",color:"primary",onClick:()=>i("general"),children:"Сохранить"})})]})}),Z=({settings:a,onChange:r,onSave:i})=>e.jsx(j,{children:e.jsxs(s,{container:!0,spacing:3,children:[e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,type:"number",label:"Минимальная длина пароля",value:a.passwordMinLength,onChange:t=>r("security","passwordMinLength",parseInt(t.target.value))})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,type:"number",label:"Максимальное количество попыток входа",value:a.maxLoginAttempts,onChange:t=>r("security","maxLoginAttempts",parseInt(t.target.value))})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,type:"number",label:"Время блокировки (минуты)",value:a.lockoutDuration,onChange:t=>r("security","lockoutDuration",parseInt(t.target.value))})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(x,{control:e.jsx(h,{checked:a.requireSpecialChars,onChange:t=>r("security","requireSpecialChars",t.target.checked)}),label:"Требовать специальные символы"})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(x,{control:e.jsx(h,{checked:a.requireNumbers,onChange:t=>r("security","requireNumbers",t.target.checked)}),label:"Требовать цифры"})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(x,{control:e.jsx(h,{checked:a.requireUppercase,onChange:t=>r("security","requireUppercase",t.target.checked)}),label:"Требовать заглавные буквы"})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(p,{variant:"contained",color:"primary",onClick:()=>i("security"),children:"Сохранить"})})]})}),ee=({settings:a,onChange:r,onSave:i,onTest:t,isTestingEmail:c})=>{const[d,u]=P.useState(!1);return e.jsx(j,{children:e.jsxs(s,{container:!0,spacing:3,children:[e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,label:"SMTP сервер",value:a.smtpServer,onChange:l=>r("email","smtpServer",l.target.value)})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,type:"number",label:"SMTP порт",value:a.smtpPort,onChange:l=>r("email","smtpPort",parseInt(l.target.value))})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,label:"SMTP пользователь",value:a.smtpUsername,onChange:l=>r("email","smtpUsername",l.target.value)})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,type:d?"text":"password",label:"SMTP пароль",value:a.smtpPassword,onChange:l=>r("email","smtpPassword",l.target.value),InputProps:{endAdornment:e.jsx(O,{position:"end",children:e.jsx(B,{onClick:()=>u(!d),edge:"end",children:d?e.jsx(R,{}):e.jsx(F,{})})})}})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,label:"Имя отправителя",value:a.senderName,onChange:l=>r("email","senderName",l.target.value)})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,type:"email",label:"Email отправителя",value:a.senderEmail,onChange:l=>r("email","senderEmail",l.target.value)})}),e.jsx(s,{item:!0,xs:12,children:e.jsxs(j,{sx:{display:"flex",gap:2},children:[e.jsx(p,{variant:"contained",color:"primary",onClick:()=>i("email"),children:"Сохранить"}),e.jsx(p,{variant:"outlined",color:"primary",onClick:t,disabled:c,children:c?"Отправка...":"Тестировать"})]})})]})})},A=[{value:"card",label:"Банковская карта"},{value:"qiwi",label:"QIWI"},{value:"yoomoney",label:"ЮMoney"}],te=({settings:a,onChange:r,onSave:i})=>e.jsx(j,{children:e.jsxs(s,{container:!0,spacing:3,children:[e.jsx(s,{item:!0,xs:12,md:6,children:e.jsxs(w,{fullWidth:!0,children:[e.jsx(k,{children:"Валюта"}),e.jsxs(E,{value:a.currency,onChange:t=>r("payment","currency",t.target.value),label:"Валюта",children:[e.jsx(m,{value:"RUB",children:"Рубль (₽)"}),e.jsx(m,{value:"USD",children:"Доллар ($)"}),e.jsx(m,{value:"EUR",children:"Евро (€)"})]})]})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,type:"number",label:"НДС (%)",value:a.vatRate,onChange:t=>r("payment","vatRate",parseInt(t.target.value))})}),e.jsx(s,{item:!0,xs:12,children:e.jsxs(w,{fullWidth:!0,children:[e.jsx(k,{children:"Способы оплаты"}),e.jsx(E,{multiple:!0,value:a.paymentMethods,onChange:t=>r("payment","paymentMethods",t.target.value),input:e.jsx(G,{label:"Способы оплаты"}),renderValue:t=>e.jsx(j,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:t.map(c=>{var d;return e.jsx(V,{label:(d=A.find(u=>u.value===c))==null?void 0:d.label},c)})}),children:A.map(t=>e.jsx(m,{value:t.value,children:t.label},t.value))})]})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,type:"number",label:"Минимальная сумма заказа",value:a.minOrderAmount,onChange:t=>r("payment","minOrderAmount",parseInt(t.target.value))})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,type:"number",label:"Максимальная сумма заказа",value:a.maxOrderAmount,onChange:t=>r("payment","maxOrderAmount",parseInt(t.target.value))})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(p,{variant:"contained",color:"primary",onClick:()=>i("payment"),children:"Сохранить"})})]})}),ae=({settings:a,onChange:r,onSave:i})=>e.jsx(j,{children:e.jsxs(s,{container:!0,spacing:3,children:[e.jsx(s,{item:!0,xs:12,children:e.jsx(x,{control:e.jsx(h,{checked:a.orderConfirmation,onChange:t=>r("notifications","orderConfirmation",t.target.checked)}),label:"Подтверждение заказа"})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(x,{control:e.jsx(h,{checked:a.orderStatusUpdate,onChange:t=>r("notifications","orderStatusUpdate",t.target.checked)}),label:"Обновление статуса заказа"})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(x,{control:e.jsx(h,{checked:a.newGameAlert,onChange:t=>r("notifications","newGameAlert",t.target.checked)}),label:"Уведомления о новых играх"})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(x,{control:e.jsx(h,{checked:a.priceDropAlert,onChange:t=>r("notifications","priceDropAlert",t.target.checked)}),label:"Уведомления о снижении цен"})}),e.jsx(s,{item:!0,xs:12,children:e.jsxs(w,{fullWidth:!0,children:[e.jsx(k,{children:"Частота рассылки"}),e.jsxs(E,{value:a.newsletterFrequency,onChange:t=>r("notifications","newsletterFrequency",t.target.value),label:"Частота рассылки",children:[e.jsx(m,{value:"daily",children:"Ежедневно"}),e.jsx(m,{value:"weekly",children:"Еженедельно"}),e.jsx(m,{value:"monthly",children:"Ежемесячно"}),e.jsx(m,{value:"never",children:"Никогда"})]})]})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(p,{variant:"contained",color:"primary",onClick:()=>i("notifications"),children:"Сохранить"})})]})}),re={general:{siteName:"",description:"",contactEmail:"",phoneNumber:"",address:""},security:{passwordMinLength:8,requireSpecialChars:!0,requireNumbers:!0,requireUppercase:!0,maxLoginAttempts:5,lockoutDuration:15},email:{smtpServer:"",smtpPort:587,smtpUsername:"",smtpPassword:"",senderName:"",senderEmail:""},payment:{currency:"RUB",vatRate:20,paymentMethods:["card","qiwi","yoomoney"],minOrderAmount:100,maxOrderAmount:5e4},notifications:{orderConfirmation:!0,orderStatusUpdate:!0,newGameAlert:!0,priceDropAlert:!0,newsletterFrequency:"weekly"}},se=()=>{const a=q(),{settings:r,isLoading:i,error:t}=N(o=>o.settings),[c,d]=v.useState("general"),[u,l]=v.useState(!1),[g,S]=v.useState(re);return v.useEffect(()=>{a(M())},[a]),v.useEffect(()=>{r&&S(r)},[r]),{settings:g,loading:i,error:t,activeTab:c,isTestingEmail:u,handleTabChange:o=>{d(o)},handleSettingChange:(o,b,C)=>{S(I=>({...I,[o]:{...I[o],[b]:C}}))},handleSaveSettings:async()=>{try{await a(U(g)).unwrap(),f.success("Настройки успешно сохранены")}catch(o){f.error(o||"Ошибка при сохранении настроек")}},handleTestEmail:async()=>{var o,b;l(!0);try{await L.testEmailSettings(g.email),f.success("Тестовое письмо отправлено успешно")}catch(C){f.error(((b=(o=C.response)==null?void 0:o.data)==null?void 0:b.message)||"Ошибка отправки тестового письма")}finally{l(!1)}}}},xe=()=>{const{settings:a,loading:r,activeTab:i,isTestingEmail:t,handleSettingChange:c,handleTabChange:d,saveSettings:u,testEmailSettings:l}=se();if(r)return e.jsx(D,{});const g=()=>{switch(i){case"general":return e.jsx(X,{settings:a.general,onChange:c,onSave:u});case"security":return e.jsx(Z,{settings:a.security,onChange:c,onSave:u});case"email":return e.jsx(ee,{settings:a.email,onChange:c,onSave:u,onTest:l,isTestingEmail:t});case"payment":return e.jsx(te,{settings:a.payment,onChange:c,onSave:u});case"notifications":return e.jsx(ae,{settings:a.notifications,onChange:c,onSave:u});default:return null}};return e.jsxs(_,{maxWidth:"lg",sx:{mt:4,mb:4},children:[e.jsx(z,{variant:"h4",component:"h1",sx:{mb:4},children:"Настройки"}),e.jsx(T,{sx:{mb:3},children:e.jsxs(H,{value:i,onChange:(S,W)=>d(W),variant:"scrollable",scrollButtons:"auto",children:[e.jsx(y,{icon:e.jsx(J,{}),label:"Общие",value:"general"}),e.jsx(y,{icon:e.jsx(Q,{}),label:"Безопасность",value:"security"}),e.jsx(y,{icon:e.jsx(Y,{}),label:"Email",value:"email"}),e.jsx(y,{icon:e.jsx($,{}),label:"Оплата",value:"payment"}),e.jsx(y,{icon:e.jsx(K,{}),label:"Уведомления",value:"notifications"})]})}),e.jsx(T,{sx:{p:3},children:g()})]})};export{xe as default};
