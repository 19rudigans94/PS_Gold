import{j as e,B as y,q as w,r as g,s as C,I as D,V as S,t as L,F as k,v as P,g as F,p as I,G as p,m as f,C as N,P as B}from"./ui-vendor-BekXbpvv.js";import{r as v,L as j,u as G,e as W}from"./react-vendor-CmdBDJ7C.js";import{u as q,b as A}from"./redux-vendor-D-krhjMU.js";import{l as E}from"./index-DbOi_nDC.js";import"./utils-upsvKRUO.js";const V=({formData:r,isLoading:t,error:o,onChange:s,onSubmit:i})=>{const[n,x]=v.useState(!1),b=()=>{x(!n)};return e.jsxs(y,{component:"form",onSubmit:i,sx:{mt:3,width:"100%"},children:[o&&e.jsx(w,{severity:"error",sx:{mb:2},children:o}),e.jsx(g,{margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email",name:"email",autoComplete:"email",autoFocus:!0,value:r.email,onChange:s,disabled:t}),e.jsx(g,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Пароль",type:n?"text":"password",id:"password",autoComplete:"current-password",value:r.password,onChange:s,disabled:t,InputProps:{endAdornment:e.jsx(C,{position:"end",children:e.jsx(D,{"aria-label":"toggle password visibility",onClick:b,edge:"end",children:n?e.jsx(S,{}):e.jsx(L,{})})})}}),e.jsx(k,{control:e.jsx(P,{name:"remember",checked:r.remember,onChange:s,color:"primary",disabled:t}),label:"Запомнить меня"}),e.jsx(F,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},disabled:t,children:t?e.jsx(I,{size:24,color:"inherit"}):"Войти"}),e.jsxs(p,{container:!0,children:[e.jsx(p,{item:!0,xs:!0,children:e.jsx(j,{to:"/forgot-password",children:e.jsx(f,{variant:"body2",color:"primary",sx:{textDecoration:"none","&:hover":{textDecoration:"underline"}},children:"Забыли пароль?"})})}),e.jsx(p,{item:!0,children:e.jsx(j,{to:"/register",children:e.jsx(f,{variant:"body2",color:"primary",sx:{textDecoration:"none","&:hover":{textDecoration:"underline"}},children:"Нет аккаунта? Зарегистрируйтесь"})})})]})]})},H=()=>e.jsxs("div",{children:[e.jsx("img",{className:"mx-auto h-12 w-auto",src:"/game-controller.svg",alt:"GameGold Logo"}),e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Войти в аккаунт"}),e.jsxs("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Или"," ",e.jsx(j,{to:"/register",className:"font-medium text-blue-600 hover:text-blue-500",children:"зарегистрируйтесь"}),", если у вас еще нет аккаунта"]})]}),R=()=>{const r=q(),t=G(),o=W(),{isLoading:s,error:i}=A(l=>l.auth),[n,x]=v.useState({email:"",password:"",remember:!1});return{formData:n,isLoading:s,error:i,handleChange:l=>{const{name:c,value:d,type:m,checked:a}=l.target;x(h=>({...h,[c]:m==="checkbox"?a:d}))},handleSubmit:async l=>{var c,d,m;l.preventDefault();try{const a=await r(E(n)).unwrap();if(a.success&&((c=a.data)!=null&&c.user)){const{user:h}=a.data,u=(m=(d=o.state)==null?void 0:d.from)==null?void 0:m.pathname;h.role==="admin"&&(!u||u==="/")?t("/admin/dashboard",{replace:!0}):u?t(u,{replace:!0}):t("/",{replace:!0})}}catch(a){console.error("Login error:",a)}}}},Q=()=>{const{formData:r,isLoading:t,error:o,handleChange:s,handleSubmit:i}=R();return e.jsx(N,{component:"main",maxWidth:"xs",children:e.jsx(y,{sx:{minHeight:"calc(100vh - 64px)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",py:4},children:e.jsxs(B,{elevation:3,sx:{p:4,width:"100%",display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(H,{}),e.jsx(V,{formData:r,isLoading:t,error:o,onChange:s,onSubmit:i})]})})})};export{Q as default};
